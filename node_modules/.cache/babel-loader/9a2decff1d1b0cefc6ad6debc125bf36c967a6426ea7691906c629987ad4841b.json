{"ast":null,"code":"var _jsxFileName = \"D:\\\\React kurs\\\\react-app-exam\\\\client\\\\src\\\\contexts\\\\AuthContext.js\",\n  _s = $RefreshSig$();\nimport { createContext, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { authServiceFactory } from \"../services/authService\";\nimport { useLocalStorage } from \"../hooks/useLocalStorage\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext();\nexport const AuthProvider = _ref => {\n  _s();\n  let {\n    children\n  } = _ref;\n  const navigate = useNavigate();\n  const [auth, setAuth] = useLocalStorage('auth', {});\n  const authService = authServiceFactory(auth.accessToken);\n  const onRegisterSubmit = async values => {\n    const {\n      confirmPassword,\n      ...registerData\n    } = values;\n    if (confirmPassword !== registerData.password) {\n      return;\n    }\n    try {\n      const result = await authService.register(registerData);\n      setAuth(result);\n      navigate(\"/catalog\");\n    } catch (error) {\n      console.log(\"There is a problem\");\n    }\n  };\n  const onLoginSubmit = async data => {\n    try {\n      const result = await authService.login(data);\n      setAuth(result);\n      navigate('/catalog');\n    } catch (error) {\n      console.log('Problem..');\n    }\n  };\n  const onLogout = async () => {\n    await authService.logout();\n    console.log(localStorage.getItem('auth'));\n    localStorage.removeItem('auth');\n    setAuth();\n  };\n  const contextValues = {\n    onRegisterSubmit,\n    onLoginSubmit,\n    onLogout,\n    userId: auth._id,\n    token: auth.accessToken,\n    userEmail: auth.email,\n    isAuthenticated: !!auth.accessToken\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n      value: contextValues,\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 13\n    }, this)\n  }, void 0, false);\n};\n_s(AuthProvider, \"gyMav3ElTVvHDz5CYLU/G/obicM=\", false, function () {\n  return [useNavigate, useLocalStorage];\n});\n_c = AuthProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["createContext","useState","useNavigate","authServiceFactory","useLocalStorage","jsxDEV","_jsxDEV","Fragment","_Fragment","AuthContext","AuthProvider","_ref","_s","children","navigate","auth","setAuth","authService","accessToken","onRegisterSubmit","values","confirmPassword","registerData","password","result","register","error","console","log","onLoginSubmit","data","login","onLogout","logout","localStorage","getItem","removeItem","contextValues","userId","_id","token","userEmail","email","isAuthenticated","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["D:/React kurs/react-app-exam/client/src/contexts/AuthContext.js"],"sourcesContent":["import {createContext, useState} from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport {authServiceFactory} from \"../services/authService\";\r\nimport {useLocalStorage} from \"../hooks/useLocalStorage\";\r\n\r\nexport const AuthContext = createContext();\r\n\r\nexport const AuthProvider = ({\r\n    children,\r\n}) => {\r\n    const navigate = useNavigate();\r\n    const [auth, setAuth] = useLocalStorage('auth', {});\r\n    const authService = authServiceFactory(auth.accessToken);\r\n\r\n\r\n    const onRegisterSubmit = async (values) => {\r\n        const { confirmPassword, ...registerData } = values;\r\n        if (confirmPassword !== registerData.password) {\r\n            return;\r\n        }\r\n        try {\r\n            const result = await authService.register(registerData);\r\n\r\n            setAuth(result);\r\n\r\n            navigate(\"/catalog\");\r\n        } catch (error) {\r\n            console.log(\"There is a problem\");\r\n        }\r\n    };\r\n\r\n    const onLoginSubmit = async (data) => {\r\n        try {\r\n            const result = await authService.login(data);\r\n\r\n            setAuth(result);\r\n\r\n            navigate('/catalog');\r\n        } catch (error) {\r\n            console.log('Problem..')\r\n        }\r\n    };\r\n\r\n    const onLogout = async () => {\r\n        await authService.logout();\r\n        console.log(localStorage.getItem('auth'))\r\n        localStorage.removeItem('auth')\r\n        setAuth();\r\n    };\r\n\r\n    const contextValues = {\r\n        onRegisterSubmit,\r\n        onLoginSubmit,\r\n        onLogout,\r\n        userId: auth._id,\r\n        token: auth.accessToken,\r\n        userEmail: auth.email,\r\n        isAuthenticated: !!auth.accessToken,\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <AuthContext.Provider value={contextValues}>\r\n                {children}\r\n            </AuthContext.Provider>\r\n        </>\r\n    )\r\n}\r\n"],"mappings":";;AAAA,SAAQA,aAAa,EAAEC,QAAQ,QAAO,OAAO;AAC7C,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,SAAQC,kBAAkB,QAAO,yBAAyB;AAC1D,SAAQC,eAAe,QAAO,0BAA0B;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAAA,SAAAC,QAAA,IAAAC,SAAA;AAEzD,OAAO,MAAMC,WAAW,gBAAGT,aAAa,EAAE;AAE1C,OAAO,MAAMU,YAAY,GAAGC,IAAA,IAEtB;EAAAC,EAAA;EAAA,IAFuB;IACzBC;EACJ,CAAC,GAAAF,IAAA;EACG,MAAMG,QAAQ,GAAGZ,WAAW,EAAE;EAC9B,MAAM,CAACa,IAAI,EAAEC,OAAO,CAAC,GAAGZ,eAAe,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;EACnD,MAAMa,WAAW,GAAGd,kBAAkB,CAACY,IAAI,CAACG,WAAW,CAAC;EAGxD,MAAMC,gBAAgB,GAAG,MAAOC,MAAM,IAAK;IACvC,MAAM;MAAEC,eAAe;MAAE,GAAGC;IAAa,CAAC,GAAGF,MAAM;IACnD,IAAIC,eAAe,KAAKC,YAAY,CAACC,QAAQ,EAAE;MAC3C;IACJ;IACA,IAAI;MACA,MAAMC,MAAM,GAAG,MAAMP,WAAW,CAACQ,QAAQ,CAACH,YAAY,CAAC;MAEvDN,OAAO,CAACQ,MAAM,CAAC;MAEfV,QAAQ,CAAC,UAAU,CAAC;IACxB,CAAC,CAAC,OAAOY,KAAK,EAAE;MACZC,OAAO,CAACC,GAAG,CAAC,oBAAoB,CAAC;IACrC;EACJ,CAAC;EAED,MAAMC,aAAa,GAAG,MAAOC,IAAI,IAAK;IAClC,IAAI;MACA,MAAMN,MAAM,GAAG,MAAMP,WAAW,CAACc,KAAK,CAACD,IAAI,CAAC;MAE5Cd,OAAO,CAACQ,MAAM,CAAC;MAEfV,QAAQ,CAAC,UAAU,CAAC;IACxB,CAAC,CAAC,OAAOY,KAAK,EAAE;MACZC,OAAO,CAACC,GAAG,CAAC,WAAW,CAAC;IAC5B;EACJ,CAAC;EAED,MAAMI,QAAQ,GAAG,MAAAA,CAAA,KAAY;IACzB,MAAMf,WAAW,CAACgB,MAAM,EAAE;IAC1BN,OAAO,CAACC,GAAG,CAACM,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,CAAC;IACzCD,YAAY,CAACE,UAAU,CAAC,MAAM,CAAC;IAC/BpB,OAAO,EAAE;EACb,CAAC;EAED,MAAMqB,aAAa,GAAG;IAClBlB,gBAAgB;IAChBU,aAAa;IACbG,QAAQ;IACRM,MAAM,EAAEvB,IAAI,CAACwB,GAAG;IAChBC,KAAK,EAAEzB,IAAI,CAACG,WAAW;IACvBuB,SAAS,EAAE1B,IAAI,CAAC2B,KAAK;IACrBC,eAAe,EAAE,CAAC,CAAC5B,IAAI,CAACG;EAC5B,CAAC;EAED,oBACIZ,OAAA,CAAAE,SAAA;IAAAK,QAAA,eACIP,OAAA,CAACG,WAAW,CAACmC,QAAQ;MAACC,KAAK,EAAER,aAAc;MAAAxB,QAAA,EACtCA;IAAQ;MAAAiC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EACU,iBACxB;AAEX,CAAC;AAAArC,EAAA,CA5DYF,YAAY;EAAA,QAGJR,WAAW,EACJE,eAAe;AAAA;AAAA8C,EAAA,GAJ9BxC,YAAY;AAAA,IAAAwC,EAAA;AAAAC,YAAA,CAAAD,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}